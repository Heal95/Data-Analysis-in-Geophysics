Exercise - Power Spectral Analysis
----------------------------------
1. In the file ar_koeficijenti.mat, there are vectors a1, a2, ..., a23, each containing the coefficients ai of the autoregressive model xt = a1xt-1 + a2xt-2 + ... + apxt-p + εt which has similar spectral properties as the sea level series measured in Bakar (a1-a8), Split (a9-a16), or Dubrovnik (a17-a23). Using the given model, examine how the power spectrum estimation through periodogram averaging (Welch's method, Matlab function psd or pwelch) depends on the series length, window length, etc. The power spectrum is a property of stationary random processes, and the autoregressive model is used here as an example of such a process. For this task, the theory of autoregressive models is not important. What matters is that the model enables generating realizations with given statistical properties (autocorrelation functions), and that the theoretical spectrum is easily calculated from the model's coefficients. Simulate 1000 time series of length 4096 (= 2^12) and save them in a mat file for later use. Take the numbers εt from the unit normal distribution. You can use the provided program arsim.m. (Using coefficients a1, a call to generate one realization might be: v = arsim(0, -a1', 1, 4096);. Here, v is the required time series, 0 is its mean, 1 is the variance of εt.) Plot several realizations in the time domain. Note that resemblance does not imply that the given model is good for simulating sea levels. Calculate the theoretical spectrum of your AR model using the provided function ar_teorijski_spektar. This function assumes that the AR model is given in the form (see above)! For series of length 256 (approx. 10 days of hourly sea level values), estimate the power spectra using the psd or pwelch function (scipy.signal.welch in Python), with data windows of length M = 32, 64, and 128. Average the obtained spectra and plot the mean (expectation of the estimator) over the theoretical spectrum. On the same plot, draw the 2.5th and 97.5th percentiles of the spectrum estimate (25th and 975th of 1000 sorted values for each frequency) and the confidence interval. Indicate the corresponding number of degrees of freedom on each plot. Do the same for series of length 4096 (approx. half a year), with M = 256, 512, 1024. Consider and discuss the bias and variability of the estimators depending on the data window length, series length, and spectrum smoothness.

2. For the i-th station for three-hour series of temperature, pressure, and both wind components, plot the series in the time domain, and then estimate the power spectra. Start with a wide data window and gradually decrease it. Also plot the confidence intervals. Examine the obtained power spectra, especially any frequencies or frequency bands with increased values in the spectrum, if any.
---------------------------------------------------------------------------------------------------------------------
Files:
-----
ar_koeficijenti.mat, ar_teorijski_spektar.m, arsim.m - Attached files and Matlab codes for task 1
files.m - Matlab code to extract data; output: my_data.m
LAMI_ECMWF_data.mat - exercise dataset for task 2 
part_1.m - Matlab code for task 1
part_2.m - Matlab code for task 2
Report.pdf - Report with figures and results in croatian